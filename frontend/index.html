<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <!-- –£–ª—É—á—à–µ–Ω–Ω—ã–µ –º–µ—Ç–∞-—Ç–µ–≥–∏ –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0"
    />
    <meta name="HandheldFriendly" content="true" />
    <meta name="MobileOptimized" content="width" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="theme-color" content="#8a9bb3" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />

    <!-- –î–ª—è iOS -->
    <link
      rel="apple-touch-icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìä</text></svg>"
    />
    <meta name="apple-mobile-web-app-title" content="–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤" />

    <!-- –î–ª—è Android -->
    <meta name="mobile-web-app-capable" content="yes" />
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤ –∏–∑ Excel</title>
    <style>
      /* –°—Ç–∏–ª–∏ –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ */
      .screen {
        display: none;
        animation: fadeIn 0.5s ease;
      }

      .screen.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* –£–ª—É—á—à–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞ */
      #backButton {
        background: linear-gradient(135deg, #8a9bb3 0%, #6a7b93 100%);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      #backButton:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(106, 123, 147, 0.3);
      }

      /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ */
      @media (prefers-color-scheme: dark) {
        #backButton {
          background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
        }

        #backButton:hover {
          box-shadow: 0 4px 12px rgba(74, 85, 104, 0.3);
        }
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ */
      @media (max-width: 768px) {
        #backButton {
          padding: 10px 16px;
          font-size: 14px;
          margin-top: 10px;
        }

        .screen.active {
          padding-top: 10px;
        }
      }

      /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å –≤ —Ç–µ—Å—Ç–µ */
      #resultSection > div:first-child {
        margin-bottom: 25px;
        padding: 20px;
        background: linear-gradient(
          135deg,
          rgba(138, 155, 179, 0.1) 0%,
          rgba(212, 180, 131, 0.05) 100%
        );
        border-radius: 12px;
        border-left: 4px solid #8a9bb3;
      }

      @media (prefers-color-scheme: dark) {
        #resultSection > div:first-child {
          background: linear-gradient(
            135deg,
            rgba(74, 85, 104, 0.2) 0%,
            rgba(45, 55, 72, 0.1) 100%
          );
          border-left-color: #4a5568;
        }
      }

      /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #1a2b3c; /* Pantone 2025: Deep Teal (–≥–ª—É–±–æ–∫–∏–π —Å–∏–Ω–µ-–∑–µ–ª–µ–Ω—ã–π) */
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        min-height: 100vh;
        transition: background-color 0.3s, color 0.3s;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      header {
        background: linear-gradient(
          135deg,
          #6a7b93 0%,
          #8a9bb3 100%
        ); /* Pantone 2025: Misty Blue */
        color: white;
        padding: 25px;
        text-align: center;
        border-radius: 12px;
        margin-bottom: 30px;
        box-shadow: 0 4px 20px rgba(106, 123, 147, 0.2);
      }

      .upload-section,
      .result-section {
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        margin-bottom: 30px;
        border: 1px solid rgba(212, 180, 131, 0.1);
        transition: all 0.3s ease;
      }

      .upload-section:hover,
      .result-section:hover {
        box-shadow: 0 6px 25px rgba(0, 0, 0, 0.12);
      }

      button {
        background: linear-gradient(
          135deg,
          #d4b483 0%,
          #c19d6b 100%
        ); /* Pantone 2025: Peach Pink –ø–µ—Ä—Å–∏–∫–æ–≤–æ-—Ä–æ–∑–æ–≤—ã–π */
        color: white;
        border: none;
        padding: 14px 28px;
        font-size: 1rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        letter-spacing: 0.3px;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(212, 180, 131, 0.3);
      }

      button:active {
        transform: translateY(0);
      }

      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        h1 {
          font-size: 1.8rem;
        }

        .upload-section,
        .result-section {
          padding: 20px;
        }
      }

      /* –ù–æ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
      h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        background: linear-gradient(
          135deg,
          #ffffff 0%,
          #d4b483 50%,
          #8a9bb3 100%
        );
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 700;
      }

      h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid rgba(212, 180, 131, 0.3);
      }

      p {
        color: #4a5568;
        margin-bottom: 15px;
      }

      /* –£–ª—É—á—à–∞–µ–º —á–µ–∫–±–æ–∫—Å—ã */
      .option-item {
        margin: 10px 0;
        padding: 15px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        transition: all 0.2s ease;
      }

      .option-item:hover {
        border-color: #8a9bb3;
        transform: translateX(5px);
      }

      .option-item input[type="checkbox"]:checked ~ span {
        color: #2c3e50;
        font-weight: 600;
      }

      .option-item input[type="checkbox"]:checked ~ .option-item {
        border-color: #d4b483;
        background-color: rgba(212, 180, 131, 0.1);
      }

      /* –£–ª—É—á—à–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
      .loading {
        display: none;
        text-align: center;
        padding: 30px;
        color: #8a9bb3;
      }

      .loading:before {
        content: "";
        display: inline-block;
        width: 24px;
        height: 24px;
        margin-right: 10px;
        border: 3px solid rgba(138, 155, 179, 0.3);
        border-radius: 50%;
        border-top-color: #8a9bb3;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* –£–ª—É—á—à–∞–µ–º –æ—à–∏–±–∫–∏ */
      .error {
        color: #c53030;
        padding: 15px;
        background-color: #fff5f5;
        border-radius: 8px;
        margin-top: 15px;
        display: none;
        border-left: 4px solid #c53030;
      }

      /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è –æ—à–∏–±–∫–∏ */
      @media (prefers-color-scheme: dark) {
        .error {
          background-color: #2d3748;
          color: #fc8181;
          border-left-color: #fc8181;
        }

        h2 {
          color: #e2e8f0;
          border-bottom-color: #4a5568;
        }

        p {
          color: #a0aec0;
        }
      }

      /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
      @media (max-width: 480px) {
        /* –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã –Ω–∞ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
        .container {
          padding: 10px;
        }

        h1 {
          font-size: 1.8rem;
        }

        h2 {
          font-size: 1.4rem;
        }

        /* –£–ª—É—á—à–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞—Å–∞–Ω–∏—è */
        button,
        input[type="file"] {
          padding: 15px;
          font-size: 16px; /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ iOS */
        }

        /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–±–ª–∞—Å—Ç—å –∫–∞—Å–∞–Ω–∏—è –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤ */
        .option-item {
          padding: 15px !important;
          margin: 12px 0 !important;
        }

        .option-item label {
          font-size: 16px;
        }

        /* –£–ª—É—á—à–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é */
        .navigation button {
          padding: 12px 15px;
          font-size: 16px;
          width: 48%;
        }

        /* –£–ª—É—á—à–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .question-text {
          font-size: 1.1rem !important;
        }
      }

      /* –î–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ */
      @media (min-width: 481px) and (max-width: 768px) {
        .container {
          padding: 15px;
        }

        .option-item {
          padding: 12px !important;
        }
      }

      /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ç–µ–º–Ω–æ–π —Ç–µ–º—ã */
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #1a1a1a;
          color: #f0f0f0;
        }

        .upload-section,
        .result-section,
        .question-card {
          background-color: #2d2d2d !important;
          color: #f0f0f0;
        }

        .option-item {
          background-color: #3d3d3d !important;
          border-color: #555 !important;
          color: #f0f0f0;
        }

        input[type="file"] {
          background-color: #3d3d3d;
          color: #f0f0f0;
          border-color: #8a9bb3;
        }
      }

      /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
      @media (max-height: 600px) and (orientation: landscape) {
        .container {
          padding: 5px;
        }

        header {
          padding: 10px;
          margin-bottom: 15px;
        }

        .upload-section,
        .result-section {
          padding: 15px;
          margin-bottom: 15px;
        }
      }

      /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ –Ω–∞ iOS */
      * {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
      }

      /* –£–ª—É—á—à–∞–µ–º —Å–∫—Ä–æ–ª–ª –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
      html {
        scroll-behavior: smooth;
        -webkit-text-size-adjust: 100%;
      }

      /* –£–ª—É—á—à–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–æ–∫—É—Å–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ */
      button:focus,
      input:focus {
        outline: 2px solid #8a9bb3;
        outline-offset: 2px;
      }

      /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ —Ñ–∞–π–ª–æ–≤ */
      .file-upload-container {
        position: relative;
        margin-bottom: 8px;
      }

      .file-upload-container input[type="file"] {
        width: 100%;
        padding: 12px 100px 12px 15px;
        border: 2px dashed #8a9bb3;
        border-radius: 8px;
        background-color: rgba(138, 155, 179, 0.05);
        cursor: pointer;
        font-size: 16px;
        transition: all 0.3s ease;
        box-sizing: border-box;
      }

      .file-upload-container input[type="file"]:hover {
        border-color: #d4b483;
        background-color: rgba(212, 180, 131, 0.05);
        box-shadow: 0 2px 8px rgba(138, 155, 179, 0.2);
      }

      .file-upload-container input[type="file"]:focus {
        outline: none;
        border-color: #6a7b93;
        box-shadow: 0 0 0 3px rgba(138, 155, 179, 0.3);
      }

      .upload-hint {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
        background: #8a9bb3;
        color: white;
        padding: 6px 16px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .file-upload-container:hover .upload-hint {
        background: #6a7b93;
      }

      .file-info {
        font-size: 14px;
        color: #6a7b93;
        margin-top: 8px;
        transition: all 0.3s ease;
      }

      .file-info span:first-child {
        font-weight: 500;
        color: #2c3e50;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ —Ñ–∞–π–ª–æ–≤ */
      @media (prefers-color-scheme: dark) {
        .file-upload-container input[type="file"] {
          border-color: #4a5568;
          background-color: rgba(74, 85, 104, 0.2);
          color: #e2e8f0;
        }

        .file-upload-container input[type="file"]:hover {
          border-color: #ed8936;
          background-color: rgba(237, 137, 54, 0.1);
        }

        .file-upload-container input[type="file"]:focus {
          border-color: #8a9bb3;
          box-shadow: 0 0 0 3px rgba(138, 155, 179, 0.3);
        }

        .upload-hint {
          background: #4a5568;
          color: #e2e8f0;
        }

        .file-upload-container:hover .upload-hint {
          background: #6a7b93;
        }

        .file-info {
          color: #a0aec0;
        }

        .file-info span:first-child {
          color: #e2e8f0;
        }
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
      @media (max-width: 768px) {
        .file-upload-container input[type="file"] {
          padding: 14px 90px 14px 12px;
          font-size: 15px;
        }

        .upload-hint {
          padding: 6px 14px;
          font-size: 13px;
          right: 12px;
        }

        .file-info {
          font-size: 13px;
        }
      }

      @media (max-width: 480px) {
        .file-upload-container input[type="file"] {
          padding: 12px 80px 12px 10px;
          font-size: 14px;
        }

        .upload-hint {
          padding: 5px 12px;
          font-size: 12px;
          right: 10px;
        }
      }

      /* –°—Ç–∏–ª–∏ –¥–ª—è –±–ª–æ–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ç–µ—Å—Ç–æ–º" */
      .share-section {
        animation: slideDown 0.5s ease;
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      #shareLink:focus {
        outline: 2px solid #d4b483;
        outline-offset: 2px;
      }

      #copyLinkBtn {
        transition: all 0.3s ease;
      }

      #copyLinkBtn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(106, 123, 147, 0.3);
      }

      /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è –±–ª–æ–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" */
      @media (prefers-color-scheme: dark) {
        .share-section div {
          background: linear-gradient(
            135deg,
            rgba(74, 85, 104, 0.2) 0%,
            rgba(45, 55, 72, 0.1) 100%
          );
          border-left-color: #ed8936;
        }

        #shareLink {
          background-color: #2d3748;
          color: #e2e8f0;
          border-color: #4a5568;
        }

        #shareLink:focus {
          border-color: #ed8936;
          outline-color: #ed8936;
        }
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –±–ª–æ–∫–∞ —Å —Å—Å—ã–ª–∫–∞–º–∏ */
      @media (max-width: 768px) {
        #networkLinksContainer div {
          flex-direction: column;
          gap: 5px;
        }

        #networkLinksContainer input {
          font-size: 12px;
        }

        #networkLinksContainer button {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>üìä –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤ –∏–∑ Excel</h1>
        <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel-—Ñ–∞–π–ª —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –ø–æ–ª—É—á–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Ç–µ—Å—Ç</p>
      </header>

      <main>
        <!-- –≠–∫—Ä–∞–Ω 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ -->
        <div id="uploadScreen" class="screen active">
          <section class="upload-section">
            <h2>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞</h2>
            <p>
              –ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel-—Ñ–∞–π–ª (.xlsx, .xls) —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
              –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–¥–µ–ª–µ–Ω—ã <strong>–ø–æ–ª—É–∂–∏—Ä–Ω—ã–º</strong> —à—Ä–∏—Ñ—Ç–æ–º.
            </p>

            <div class="form-group">
              <label
                for="excelFile"
                style="
                  display: block;
                  margin-bottom: 12px;
                  font-weight: 600;
                  color: #2c3e50;
                "
              >
                –í—ã–±–µ—Ä–∏—Ç–µ Excel-—Ñ–∞–π–ª:
              </label>

              <div
                class="file-upload-container"
                style="position: relative; margin-bottom: 5px"
              >
                <input
                  type="file"
                  id="excelFile"
                  name="excelFile"
                  accept=".xlsx, .xls"
                  style="
                    width: 100%;
                    padding: 12px;
                    border: 2px dashed #8a9bb3;
                    border-radius: 8px;
                    background-color: rgba(138, 155, 179, 0.05);
                    cursor: pointer;
                    font-size: 16px;
                    transition: all 0.3s ease;
                  "
                />

                <div
                  class="upload-hint"
                  style="
                    position: absolute;
                    right: 15px;
                    top: 50%;
                    transform: translateY(-50%);
                    pointer-events: none;
                    background: #8a9bb3;
                    color: white;
                    padding: 4px 12px;
                    border-radius: 4px;
                    font-size: 14px;
                  "
                >
                  –í—ã–±—Ä–∞—Ç—å
                </div>
              </div>

              <div
                class="file-info"
                id="fileInfo"
                style="
                  font-size: 14px;
                  color: #6a7b93;
                  margin-top: 8px;
                  display: none;
                "
              >
                <span id="fileName">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</span>
                <span id="fileSize" style="margin-left: 10px"></span>
              </div>
            </div>

            <button
              id="uploadButton"
              style="
                width: 100%;
                margin-top: 20px;
                padding: 16px;
                font-size: 1.1rem;
                font-weight: 600;
                background: linear-gradient(135deg, #d4b483 0%, #c19d6b 100%);
                color: white;
                border: none;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 4px 12px rgba(212, 180, 131, 0.2);
              "
            >
              üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç
            </button>

            <div class="loading" id="loading">
              <div
                style="
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  gap: 10px;
                "
              >
                <div
                  class="spinner"
                  style="
                    width: 24px;
                    height: 24px;
                    border: 3px solid rgba(138, 155, 179, 0.3);
                    border-top-color: #8a9bb3;
                    border-radius: 50%;
                    animation: spin 1s linear infinite;
                  "
                ></div>
                <span>–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –ø–æ–¥–æ–∂–¥–∏—Ç–µ...</span>
              </div>
            </div>

            <div class="error" id="errorMessage"></div>
          </section>
        </div>

        <!-- –≠–∫—Ä–∞–Ω 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ -->
        <div id="testScreen" class="screen">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 20px;
            "
          >
            <h2>üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
            <button
              id="backButton"
              style="
                background: linear-gradient(135deg, #8a9bb3 0%, #6a7b93 100%);
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 8px;
                cursor: pointer;
                transition: all 0.3s ease;
                font-size: 0.9rem;
              "
            >
              ‚Üê –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥—Ä—É–≥–æ–π —Ñ–∞–π–ª
            </button>
          </div>

          <section class="result-section" id="resultSection">
            <div
              style="
                margin-bottom: 20px;
                padding: 15px;
                background: rgba(138, 155, 179, 0.1);
                border-radius: 10px;
                border-left: 4px solid #8a9bb3;
              "
            >
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  flex-wrap: wrap;
                "
              >
                <div>
                  <strong>–§–∞–π–ª:</strong>
                  <span id="currentFileName">–ù–µ –≤—ã–±—Ä–∞–Ω</span>
                </div>
                <div>
                  <strong>–í–æ–ø—Ä–æ—Å–æ–≤:</strong>
                  <span id="totalQuestions">0</span> |
                  <strong>–¢–µ–∫—É—â–∏–π:</strong>
                  <span id="currentQuestion">1</span>/<span id="totalQuestions2"
                    >0</span
                  >
                </div>
              </div>
            </div>

            <!-- –ë–ª–æ–∫ –¥–ª—è —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ç–µ—Å—Ç -->
            <!-- –ë–ª–æ–∫ –¥–ª—è —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ç–µ—Å—Ç -->
            <div
              class="share-section"
              id="shareSection"
              style="display: none; margin-bottom: 30px"
            >
              <div
                style="
                  background: linear-gradient(
                    135deg,
                    rgba(138, 155, 179, 0.1) 0%,
                    rgba(212, 180, 131, 0.05) 100%
                  );
                  padding: 20px;
                  border-radius: 12px;
                  border-left: 4px solid #d4b483;
                "
              >
                <h3 style="margin-top: 0; color: #2c3e50">
                  üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ç–µ—Å—Ç–æ–º
                </h3>
                <p style="margin-bottom: 15px; color: #4a5568">
                  –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É, —á—Ç–æ–±—ã –¥—Ä—É–≥–∏–µ –º–æ–≥–ª–∏ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏
                  —Ñ–∞–π–ª–∞:
                </p>

                <!-- –°—Å—ã–ª–∫–∞ –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ -->
                <div style="margin-bottom: 20px">
                  <p
                    style="margin-bottom: 8px; font-weight: 600; color: #2c3e50"
                  >
                    –î–ª—è —ç—Ç–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞:
                  </p>
                  <div style="display: flex; gap: 10px; margin-bottom: 10px">
                    <input
                      type="text"
                      id="localLink"
                      readonly
                      style="
                        flex: 1;
                        padding: 12px;
                        border: 2px solid #8a9bb3;
                        border-radius: 8px;
                        font-size: 14px;
                        background: white;
                      "
                    />
                    <button
                      id="copyLocalLinkBtn"
                      style="
                        padding: 12px 24px;
                        background: linear-gradient(
                          135deg,
                          #8a9bb3 0%,
                          #6a7b93 100%
                        );
                        color: white;
                        border: none;
                        border-radius: 8px;
                        cursor: pointer;
                        font-weight: 600;
                      "
                    >
                      –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                  </div>
                </div>

                <!-- –°—Å—ã–ª–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
                <!-- –°—Å—ã–ª–∫–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
                <div id="networkLinksSection">
                  <p
                    style="margin-bottom: 8px; font-weight: 600; color: #2c3e50"
                  >
                    –î–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞/–¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤:
                  </p>

                  <!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ IP-–∞–¥—Ä–µ—Å–∞ -->
                  <div id="networkLinksContainer">
                    <!-- –°–µ—Ç–µ–≤—ã–µ —Å—Å—ã–ª–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ -->
                  </div>

                  <!-- –†—É—á–Ω–æ–π –≤–≤–æ–¥ IP-–∞–¥—Ä–µ—Å–∞ -->
                  <div
                    style="
                      margin-top: 15px;
                      padding: 15px;
                      background: rgba(138, 155, 179, 0.05);
                      border-radius: 8px;
                    "
                  >
                    <p
                      style="
                        margin-bottom: 8px;
                        font-weight: 600;
                        color: #2c3e50;
                      "
                    >
                      –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –≤–≤–µ–¥–∏—Ç–µ IP –≤—Ä—É—á–Ω—É—é:
                    </p>
                    <div style="display: flex; gap: 10px; margin-bottom: 10px">
                      <input
                        type="text"
                        id="manualIP"
                        placeholder="192.168.x.x"
                        style="
                          flex: 1;
                          padding: 12px;
                          border: 2px solid #d4b483;
                          border-radius: 8px;
                          font-size: 14px;
                        "
                      />
                      <button
                        id="generateManualLinkBtn"
                        style="
                          padding: 12px 24px;
                          background: linear-gradient(
                            135deg,
                            #d4b483 0%,
                            #c19d6b 100%
                          );
                          color: white;
                          border: none;
                          border-radius: 8px;
                          cursor: pointer;
                          font-weight: 600;
                        "
                      >
                        –°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É
                      </button>
                    </div>
                    <div id="manualLinkContainer" style="display: none">
                      <div style="display: flex; gap: 10px; margin-top: 10px">
                        <input
                          type="text"
                          id="manualLink"
                          readonly
                          style="
                            flex: 1;
                            padding: 12px;
                            border: 2px solid #8a9bb3;
                            border-radius: 8px;
                            font-size: 14px;
                            background: white;
                          "
                        />
                        <button
                          id="copyManualLinkBtn"
                          style="
                            padding: 12px 24px;
                            background: linear-gradient(
                              135deg,
                              #8a9bb3 0%,
                              #6a7b93 100%
                            );
                            color: white;
                            border: none;
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: 600;
                          "
                        >
                          –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
                  <div
                    style="
                      margin-top: 15px;
                      padding: 12px;
                      background: rgba(212, 180, 131, 0.1);
                      border-radius: 8px;
                      font-size: 13px;
                    "
                  >
                    <p style="margin: 0; color: #2c3e50">
                      <strong>–ö–∞–∫ —É–∑–Ω–∞—Ç—å IP-–∞–¥—Ä–µ—Å:</strong>
                    </p>
                    <ol
                      style="margin: 8px 0 0 15px; padding: 0; color: #4a5568"
                    >
                      <li>–ù–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –Ω–∞–∂–º–∏—Ç–µ <strong>Win + R</strong></li>
                      <li>–í–≤–µ–¥–∏—Ç–µ <code>cmd</code> –∏ –Ω–∞–∂–º–∏—Ç–µ Enter</li>
                      <li>
                        –í —á–µ—Ä–Ω–æ–º –æ–∫–Ω–µ –≤–≤–µ–¥–∏—Ç–µ <code>ipconfig</code> –∏ –Ω–∞–∂–º–∏—Ç–µ
                        Enter
                      </li>
                      <li>–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É <strong>IPv4-–∞–¥—Ä–µ—Å</strong></li>
                    </ol>
                  </div>
                </div>

                <div
                  style="
                    display: flex;
                    align-items: center;
                    color: #6a7b93;
                    font-size: 14px;
                    margin-top: 15px;
                  "
                >
                  <span>üîó –°—Å—ã–ª–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ 24 —á–∞—Å–∞</span>
                  <span style="margin-left: auto"
                    >üìÖ –°–æ–∑–¥–∞–Ω: <span id="testCreated"></span
                  ></span>
                </div>
              </div>
            </div>

            <!-- –ë–ª–æ–∫ —Å –æ–¥–Ω–∏–º –≤–æ–ø—Ä–æ—Å–æ–º -->
            <div class="question-display" id="questionDisplay">
              <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å -->
            </div>

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <div
              class="navigation"
              style="
                display: flex;
                justify-content: space-between;
                margin-top: 20px;
              "
            >
              <button id="prevButton" style="display: none">
                ‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π
              </button>
              <button id="nextButton">–°–ª–µ–¥—É—é—â–∏–π ‚Üí</button>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
            <div style="margin-top: 30px">
              <button
                id="checkButton"
                style="
                  background-color: #cccccc;
                  cursor: not-allowed;
                  width: 100%;
                  padding: 15px;
                  font-size: 1.1rem;
                  font-weight: 600;
                "
                disabled
              >
                –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (0/0)
              </button>
              <div
                id="testResult"
                style="
                  display: none;
                  margin-top: 20px;
                  padding: 15px;
                  border-radius: 5px;
                "
              ></div>
            </div>
          </section>
        </div>
      </main>

      <footer style="text-align: center; margin-top: 40px; color: #8a9bb3">
        <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ü–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É Pantone 2025 –≥–æ–¥–∞</p>
      </footer>
    </div>

    <script>
      // ========== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ö–û–†–†–ï–ö–¶–ò–ò –ö–û–î–ò–†–û–í–ö–ò ==========
      function fixEncoding(str) {
        if (!str) return str;

        // –ü—Ä–æ–±—É–µ–º –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –∏—Å–∫–∞–∂–µ–Ω–∞ (UTF-8 -> Latin1)
        try {
          // –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏—Å–∫–∞–∂–µ–Ω–Ω–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
          if (str.includes("√ê") || str.includes("√ë")) {
            // –ü—Ä–æ–±—É–µ–º –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥–∏—Ä–æ–≤–∫—É
            return decodeURIComponent(escape(str));
          }

          // –ü—Ä–æ–±—É–µ–º –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∫ URL-encoded —Å—Ç—Ä–æ–∫—É
          if (str.includes("%")) {
            try {
              return decodeURIComponent(str);
            } catch (e) {
              // –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
            }
          }

          return str;
        } catch (e) {
          console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏:", e);
          return str;
        }
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
      document.addEventListener("DOMContentLoaded", function () {
        console.log("DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏...");
        initCopyButtons();
      });

      // ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
      let allQuestions = [];
      let currentQuestionIndex = 0;
      let userAnswers = {};

      // ========== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ö–û–ü–ò–†–û–í–ê–ù–ò–Ø ==========
      async function copyToClipboard(text, buttonElement) {
        console.log("–ü–æ–ø—ã—Ç–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:", text);

        try {
          // –ü—Ä–æ–±—É–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Clipboard API
          if (navigator.clipboard && navigator.clipboard.writeText) {
            await navigator.clipboard.writeText(text);
            console.log("–£—Å–ø–µ—à–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ Clipboard API");
            showCopySuccess(buttonElement);
            return true;
          } else {
            // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
            return fallbackCopyToClipboard(text, buttonElement);
          }
        } catch (err) {
          console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ Clipboard API:", err);
          // –ü—Ä–æ–±—É–µ–º fallback –º–µ—Ç–æ–¥
          return fallbackCopyToClipboard(text, buttonElement);
        }
      }

      // Fallback –º–µ—Ç–æ–¥ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
      function fallbackCopyToClipboard(text, buttonElement) {
        console.log("–ò—Å–ø–æ–ª—å–∑—É–µ–º fallback –º–µ—Ç–æ–¥");

        // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π textarea
        const textArea = document.createElement("textarea");
        textArea.value = text;

        // –î–µ–ª–∞–µ–º textarea –Ω–µ–≤–∏–¥–∏–º–æ–π
        textArea.style.position = "fixed";
        textArea.style.top = "0";
        textArea.style.left = "0";
        textArea.style.width = "2em";
        textArea.style.height = "2em";
        textArea.style.padding = "0";
        textArea.style.border = "none";
        textArea.style.outline = "none";
        textArea.style.boxShadow = "none";
        textArea.style.background = "transparent";

        document.body.appendChild(textArea);

        try {
          // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç
          textArea.select();
          textArea.setSelectionRange(0, 99999); // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

          // –ü—Ä–æ–±—É–µ–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
          const successful = document.execCommand("copy");

          if (successful) {
            console.log("–£—Å–ø–µ—à–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ execCommand");
            showCopySuccess(buttonElement);
            document.body.removeChild(textArea);
            return true;
          } else {
            console.warn("execCommand –Ω–µ —É–¥–∞–ª—Å—è");
            showCopyManual(text, buttonElement);
            document.body.removeChild(textArea);
            return false;
          }
        } catch (err) {
          console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ execCommand:", err);
          showCopyManual(text, buttonElement);
          document.body.removeChild(textArea);
          return false;
        }
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
      function showCopyManual(text, buttonElement) {
        if (!buttonElement) return;

        const originalText = buttonElement.textContent;
        const originalBackground = buttonElement.style.background;

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
        buttonElement.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é";
        buttonElement.style.background =
          "linear-gradient(135deg, #ff9800 0%, #f57c00 100%)";

        // –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç
        const tempClickListener = () => {
          alert(`–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç—É —Å—Å—ã–ª–∫—É:\n\n${text}`);
          buttonElement.removeEventListener("click", tempClickListener);
        };

        buttonElement.addEventListener("click", tempClickListener);

        setTimeout(() => {
          buttonElement.textContent = originalText;
          buttonElement.style.background = originalBackground;
          buttonElement.removeEventListener("click", tempClickListener);
        }, 3000);
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å —É—Å–ø–µ—Ö –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
      function showCopySuccess(buttonElement) {
        if (!buttonElement) return;

        const originalText = buttonElement.textContent;
        const originalBackground = buttonElement.style.background;

        buttonElement.textContent = "‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!";
        buttonElement.style.background =
          "linear-gradient(135deg, #4caf50 0%, #2e7d32 100%)";
        buttonElement.style.cursor = "default";

        setTimeout(() => {
          buttonElement.textContent = originalText;
          buttonElement.style.background = originalBackground;
          buttonElement.style.cursor = "pointer";
        }, 2000);
      }

      // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ö–ù–û–ü–û–ö –ö–û–ü–ò–†–û–í–ê–ù–ò–Ø ==========
      function initCopyButtons() {
        console.log("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è...");

        // 1. –õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
        const localCopyBtn = document.getElementById("copyLocalLinkBtn");
        if (localCopyBtn) {
          localCopyBtn.addEventListener("click", async function () {
            const linkInput = document.getElementById("localLink");
            if (linkInput && linkInput.value) {
              await copyToClipboard(linkInput.value, this);
            } else {
              console.error("–ù–µ –Ω–∞–π–¥–µ–Ω localLink –∏–ª–∏ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ");
              alert("–ù–µ—Ç —Å—Å—ã–ª–∫–∏ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è");
            }
          });
        }

        // 2. –†—É—á–Ω–∞—è —Å—Å—ã–ª–∫–∞
        const copyManualBtn = document.getElementById("copyManualLinkBtn");
        if (copyManualBtn) {
          copyManualBtn.addEventListener("click", async function () {
            const linkInput = document.getElementById("manualLink");
            if (linkInput && linkInput.value) {
              await copyToClipboard(linkInput.value, this);
            } else {
              alert("–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Å—Å—ã–ª–∫—É");
            }
          });
        }

        // 3. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–Ω–æ–ø–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö —Å—Å—ã–ª–æ–∫ (–¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π)
        document.addEventListener("click", async function (e) {
          if (
            e.target &&
            e.target.classList &&
            e.target.classList.contains("copyNetworkLinkBtn")
          ) {
            const link = e.target.getAttribute("data-link");
            if (link) {
              console.log("–ö–æ–ø–∏—Ä—É–µ–º —Å–µ—Ç–µ–≤—É—é —Å—Å—ã–ª–∫—É:", link);
              await copyToClipboard(link, e.target);
            }
          }
        });

        // 4. –ö–Ω–æ–ø–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä—É—á–Ω–æ–π —Å—Å—ã–ª–∫–∏
        const generateBtn = document.getElementById("generateManualLinkBtn");
        if (generateBtn) {
          generateBtn.addEventListener("click", function () {
            const ipInput = document.getElementById("manualIP");
            const linkContainer = document.getElementById(
              "manualLinkContainer"
            );
            const linkInput = document.getElementById("manualLink");

            if (!ipInput || !ipInput.value) {
              alert("–í–≤–µ–¥–∏—Ç–µ IP-–∞–¥—Ä–µ—Å");
              return;
            }

            const ip = ipInput.value.trim();
            // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ IP
            if (!/^\d{1,3}(\.\d{1,3}){3}$/.test(ip)) {
              alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π IP-–∞–¥—Ä–µ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.100)");
              return;
            }

            if (window.currentTestId) {
              const link = `http://${ip}:5000/test/${window.currentTestId}`;
              linkInput.value = link;
              linkContainer.style.display = "block";
              console.log("–°–æ–∑–¥–∞–Ω–∞ —Ä—É—á–Ω–∞—è —Å—Å—ã–ª–∫–∞:", link);

              // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Å–æ–∑–¥–∞–Ω–Ω–æ–π —Å—Å—ã–ª–∫–µ
              linkContainer.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
            } else {
              alert("–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ—Å—Ç");
            }
          });
        }

        console.log("–ö–Ω–æ–ø–∫–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã");
      }

      // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –≠–ö–†–ê–ù–ê–ú–ò ==========
      function showUploadScreen() {
        document.getElementById("uploadScreen").classList.add("active");
        document.getElementById("testScreen").classList.remove("active");

        document.getElementById("excelFile").value = "";
        document.getElementById("fileInfo").style.display = "none";
        document.getElementById("fileName").textContent = "–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω";
        document.getElementById("fileSize").textContent = "";

        document.getElementById("testResult").style.display = "none";
        document.getElementById("testResult").innerHTML = "";
      }

      function showTestScreen() {
        document.getElementById("uploadScreen").classList.remove("active");
        document.getElementById("testScreen").classList.add("active");
      }

      // ========== –û–ë–†–ê–ë–û–¢–ö–ê –§–ê–ô–õ–û–í ==========
      document
        .getElementById("excelFile")
        .addEventListener("change", function (e) {
          const fileInfo = document.getElementById("fileInfo");
          const fileName = document.getElementById("fileName");
          const fileSize = document.getElementById("fileSize");

          if (this.files && this.files[0]) {
            const file = this.files[0];
            fileName.textContent = fixEncoding(file.name);

            const size = file.size;
            let sizeText = "";
            if (size < 1024) {
              sizeText = size + " –ë";
            } else if (size < 1024 * 1024) {
              sizeText = (size / 1024).toFixed(1) + " –ö–ë";
            } else {
              sizeText = (size / (1024 * 1024)).toFixed(1) + " –ú–ë";
            }
            fileSize.textContent = "(" + sizeText + ")";

            fileInfo.style.display = "block";
          } else {
            fileName.textContent = "–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω";
            fileSize.textContent = "";
            fileInfo.style.display = "none";
          }
        });

      document
        .getElementById("uploadButton")
        .addEventListener("click", function () {
          const fileInput = document.getElementById("excelFile");
          const file = fileInput.files[0];

          console.log("–ö–Ω–æ–ø–∫–∞ –Ω–∞–∂–∞—Ç–∞, —Ñ–∞–π–ª:", file);

          if (!file) {
            showError("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª");
            return;
          }

          const allowedExtensions = [".xlsx", ".xls"];
          const fileExtension = file.name
            .substring(file.name.lastIndexOf("."))
            .toLowerCase();

          if (!allowedExtensions.includes(fileExtension)) {
            showError("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª (.xlsx –∏–ª–∏ .xls)");
            return;
          }

          document.getElementById("loading").style.display = "block";
          document.getElementById("errorMessage").style.display = "none";

          const formData = new FormData();
          formData.append("excelFile", file);

          fetch("/api/upload", {
            method: "POST",
            body: formData,
          })
            .then((response) => {
              console.log("–û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω:", response.status);
              if (!response.ok) {
                throw new Error("–°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª –æ—à–∏–±–∫–æ–π: " + response.status);
              }
              return response.json();
            })
            .then((data) => {
              console.log("–î–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:", data);
              document.getElementById("loading").style.display = "none";

              if (data.success) {
                // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–¥–∏—Ä–æ–≤–∫—É –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
                const fileName = fixEncoding(data.originalname);
                document.getElementById("currentFileName").textContent =
                  fileName;
                showTestScreen();
                document.getElementById("shareSection").style.display = "block";
                document.getElementById("testCreated").textContent =
                  new Date().toLocaleString("ru-RU");
                window.currentTestId = data.testId;
                document.getElementById("localLink").value = data.localLink;

                const networkLinksContainer = document.getElementById(
                  "networkLinksContainer"
                );
                networkLinksContainer.innerHTML = "";

                if (data.networkLinks && data.networkLinks.length > 0) {
                  data.networkLinks.forEach((link, index) => {
                    const linkDiv = document.createElement("div");
                    linkDiv.style.cssText =
                      "display: flex; gap: 10px; margin-bottom: 10px;";

                    linkDiv.innerHTML = `
                            <input type="text" value="${link}" readonly
                                   style="flex: 1; padding: 12px; border: 2px solid #8a9bb3;
                                          border-radius: 8px; font-size: 14px; background: white;">
                            <button class="copyNetworkLinkBtn" data-link="${link}"
                                    style="padding: 12px 24px; background: linear-gradient(135deg, #8a9bb3 0%, #6a7b93 100%);
                                           color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        `;
                    networkLinksContainer.appendChild(linkDiv);
                  });
                } else {
                  networkLinksContainer.innerHTML =
                    '<p style="color: #666; font-style: italic;">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –∞–¥—Ä–µ—Å–æ–≤</p>';
                }

                document.getElementById("resultSection").style.display =
                  "block";
                document.getElementById("totalQuestions").textContent =
                  data.total;
                document.getElementById("totalQuestions2").textContent =
                  data.total;
                document.getElementById("currentQuestion").textContent = "1";

                displayQuestions(data.questions);
              } else {
                showError(data.message || "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞");
              }
            })
            .catch((error) => {
              console.error("–û—à–∏–±–∫–∞:", error);
              document.getElementById("loading").style.display = "none";
              showError("–û—à–∏–±–∫–∞: " + error.message);
            });
        });

      // ========== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï ==========
      function displayQuestions(questions) {
        allQuestions = questions;
        currentQuestionIndex = 0;
        userAnswers = {};

        document.getElementById("totalQuestions").textContent =
          questions.length;
        document.getElementById("totalQuestions2").textContent =
          questions.length;
        document.getElementById("currentQuestion").textContent = "1";

        showQuestion(currentQuestionIndex);
        updateCheckButton();
      }

      function showQuestion(index) {
        const question = allQuestions[index];
        const container = document.getElementById("questionDisplay");

        document.getElementById("currentQuestion").textContent = index + 1;

        document.getElementById("prevButton").style.display =
          index === 0 ? "none" : "block";
        document.getElementById("nextButton").style.display =
          index === allQuestions.length - 1 ? "none" : "block";

        let optionsHtml = '<div class="options-list">';
        question.options.forEach((option, optionIndex) => {
          const questionId = question.id || index;
          const isChecked =
            userAnswers[questionId] &&
            userAnswers[questionId].includes(optionIndex);

          optionsHtml += `
            <div class="option-item" style="margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <label style="display: flex; align-items: center; cursor: pointer;">
                    <input type="checkbox"
                           data-question="${questionId}"
                           data-option="${optionIndex}"
                           ${isChecked ? "checked" : ""}
                           style="margin-right: 10px; transform: scale(1.2);">
                    <span>${option.text}</span>
                </label>
            </div>
        `;
        });
        optionsHtml += "</div>";

        container.innerHTML = `
        <div class="question-card" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
            <div class="question-text" style="font-size: 1.2rem; font-weight: bold; margin-bottom: 20px; color: #2c3e50;">
                ${index + 1}. ${question.text}
            </div>
            ${optionsHtml}
            <p style="margin-top: 15px; color: #666; font-size: 0.9rem;">
                <strong>–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Ç–≤–µ—Ç–æ–≤</strong>, –µ—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –¥–æ–ø—É—Å–∫–∞–µ—Ç —ç—Ç–æ
            </p>
        </div>
    `;

        container
          .querySelectorAll('input[type="checkbox"]')
          .forEach((checkbox) => {
            checkbox.addEventListener("change", function () {
              const questionId = this.getAttribute("data-question");
              const optionIndex = parseInt(this.getAttribute("data-option"));

              if (!userAnswers[questionId]) {
                userAnswers[questionId] = [];
              }

              if (this.checked) {
                if (!userAnswers[questionId].includes(optionIndex)) {
                  userAnswers[questionId].push(optionIndex);
                }
              } else {
                userAnswers[questionId] = userAnswers[questionId].filter(
                  (i) => i !== optionIndex
                );
              }

              if (
                userAnswers[questionId] &&
                userAnswers[questionId].length === 0
              ) {
                delete userAnswers[questionId];
              }

              updateCheckButton();
            });
          });
      }

      document
        .getElementById("prevButton")
        .addEventListener("click", function () {
          if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            showQuestion(currentQuestionIndex);
          }
        });

      document
        .getElementById("nextButton")
        .addEventListener("click", function () {
          if (currentQuestionIndex < allQuestions.length - 1) {
            currentQuestionIndex++;
            showQuestion(currentQuestionIndex);
          }
        });

      function updateCheckButton() {
        const checkButton = document.getElementById("checkButton");
        const totalQuestions = allQuestions.length;

        if (totalQuestions === 0) {
          checkButton.disabled = true;
          checkButton.style.backgroundColor = "#cccccc";
          checkButton.style.cursor = "not-allowed";
          checkButton.textContent = `–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (0/0)`;
          return;
        }

        let answeredCount = 0;
        for (let i = 0; i < totalQuestions; i++) {
          const questionId = allQuestions[i].id || i;
          if (userAnswers[questionId] && userAnswers[questionId].length > 0) {
            answeredCount++;
          }
        }

        const allAnswered = answeredCount === totalQuestions;

        if (allAnswered) {
          checkButton.disabled = false;
          checkButton.style.backgroundColor = "#4caf50";
          checkButton.style.cursor = "pointer";
          checkButton.textContent = `–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∏ –æ—Ç–≤–µ—Ç—ã ‚úì (${answeredCount}/${totalQuestions})`;
        } else {
          checkButton.disabled = true;
          checkButton.style.backgroundColor = "#cccccc";
          checkButton.style.cursor = "not-allowed";
          checkButton.textContent = `–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (${answeredCount}/${totalQuestions})`;
        }
      }

      function canCheckAnswers() {
        const totalQuestions = allQuestions.length;
        if (totalQuestions === 0) return false;

        for (let i = 0; i < totalQuestions; i++) {
          const questionId = allQuestions[i].id || i;
          if (
            !userAnswers[questionId] ||
            userAnswers[questionId].length === 0
          ) {
            return false;
          }
        }
        return true;
      }

      document
        .getElementById("checkButton")
        .addEventListener("click", function () {
          if (!canCheckAnswers()) {
            alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π!");
            return;
          }
          checkAnswers();
        });

      function checkAnswers() {
        let correctCount = 0;
        let totalQuestions = allQuestions.length;
        let resultHtml = "";

        allQuestions.forEach((question, index) => {
          const questionId = question.id || index;
          const userSelected = userAnswers[questionId] || [];
          const correctOptions = [];

          question.options.forEach((option, optionIndex) => {
            if (option.isCorrect) {
              correctOptions.push(optionIndex);
            }
          });

          const isCorrect =
            userSelected.length === correctOptions.length &&
            userSelected.every((opt) => correctOptions.includes(opt));

          if (isCorrect) {
            correctCount++;
          }

          resultHtml += `
            <div style="margin: 10px 0; padding: 10px; border-left: 4px solid ${
              isCorrect ? "#4caf50" : "#f44336"
            }; background: #f9f9f9;">
                <strong>–í–æ–ø—Ä–æ—Å ${index + 1}:</strong> ${question.text}<br>
                <span style="color: ${isCorrect ? "#4caf50" : "#f44336"}">
                    ${isCorrect ? "‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ!" : "‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ"}
                </span>
            </div>
        `;
        });

        const score = Math.round((correctCount / totalQuestions) * 100);
        const resultDiv = document.getElementById("testResult");

        resultDiv.innerHTML = `
        <h3 style="color: #2c3e50;">–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞</h3>
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
            <div style="font-size: 2rem; color: ${
              score >= 70 ? "#4caf50" : score >= 50 ? "#ff9800" : "#f44336"
            }; font-weight: bold;">
                ${score}%
            </div>
            <p>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${correctCount} –∏–∑ ${totalQuestions}</p>
            <div style="margin-top: 20px;">
                <h4>–î–µ—Ç–∞–ª–∏:</h4>
                ${resultHtml}
            </div>
            <button onclick="retakeTest()" style="margin-top: 20px; background-color: #8a9bb3; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç —Å–Ω–æ–≤–∞
            </button>
        </div>
    `;

        resultDiv.style.display = "block";
        resultDiv.scrollIntoView({ behavior: "smooth" });
      }

      // ========== –ó–ê–ì–†–£–ó–ö–ê –ü–û –°–°–´–õ–ö–ï ==========
      function loadTestByLink(testId) {
        console.log("=== –ù–ê–ß–ê–õ–û –ó–ê–ì–†–£–ó–ö–ò –¢–ï–°–¢–ê –ü–û –°–°–´–õ–ö–ï ===");
        console.log("ID —Ç–µ—Å—Ç–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏:", testId);

        document.getElementById("loading").style.display = "block";
        document.getElementById("loading").innerHTML = `
        <div style="display: flex; align-items: center; justify-content: center; gap: 10px;">
            <div class="spinner" style="width: 24px; height: 24px; border: 3px solid rgba(138, 155, 179, 0.3);
                 border-top-color: #8a9bb3; border-radius: 50%; animation: spin 1s linear infinite;"></div>
            <span>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–∞ –ø–æ —Å—Å—ã–ª–∫–µ...</span>
        </div>
    `;

        fetch(`/api/test/${testId}`)
          .then((response) => {
            console.log("–û—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–ª—É—á–µ–Ω");
            console.log("–°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:", response.status);

            if (!response.ok) {
              throw new Error("–°–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—Ç–∏–ª –æ—à–∏–±–∫–æ–π: " + response.status);
            }
            return response.json();
          })
          .then((data) => {
            console.log("–î–∞–Ω–Ω—ã–µ –æ—Ç API:", data);
            document.getElementById("loading").style.display = "none";

            if (data.success) {
              console.log("‚úÖ –¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!");
              const fileName = fixEncoding(data.originalname);
              document.getElementById("currentFileName").textContent =
                fileName + " (–ø–æ —Å—Å—ã–ª–∫–µ)";
              data.originalname + " (–ø–æ —Å—Å—ã–ª–∫–µ)";
              showTestScreen();
              document.getElementById("shareSection").style.display = "none";
              document.getElementById("backButton").style.display = "none";
              document.getElementById("resultSection").style.display = "block";
              document.getElementById("totalQuestions").textContent =
                data.total;
              document.getElementById("totalQuestions2").textContent =
                data.total;
              document.getElementById("currentQuestion").textContent = "1";
              displayQuestions(data.questions);
              window.currentTestId = testId;
            } else {
              console.log("‚ùå –û—à–∏–±–∫–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:", data.message);
              showError(data.message || "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ—Å—Ç");
              showUploadScreen();
            }
          })
          .catch((error) => {
            document.getElementById("loading").style.display = "none";
            console.error("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Å—Ç–∞:", error);

            let errorMessage = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Å—Ç–∞. ";
            if (error.message.includes("Failed to fetch")) {
              errorMessage += "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É.";
            } else {
              errorMessage += error.message;
            }

            showError(errorMessage);
            showUploadScreen();
          });
      }

      // ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==========
      function showError(message) {
        const errorDiv = document.getElementById("errorMessage");
        if (errorDiv) {
          errorDiv.textContent = message;
          errorDiv.style.display = "block";

          setTimeout(() => {
            errorDiv.style.display = "none";
          }, 5000);
        } else {
          console.error("–û—à–∏–±–∫–∞:", message);
          alert(message);
        }
      }

      function retakeTest() {
        // –û—á–∏—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        document.getElementById("testResult").style.display = "none";
        document.getElementById("testResult").innerHTML = "";

        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        userAnswers = {};

        // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç
        if (allQuestions && allQuestions.length > 0) {
          currentQuestionIndex = 0;
          showQuestion(currentQuestionIndex);
          document.getElementById("testContainer").scrollIntoView({ behavior: "smooth" });
        } else {
          // –ï—Å–ª–∏ —Ç–µ—Å—Ç–∞ –Ω–µ—Ç –≤ –ø–∞–º—è—Ç–∏ - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
          location.reload();
        }
      }

      // ========== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ==========
      document
        .getElementById("backButton")
        .addEventListener("click", function () {
          if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã? –¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ—Å—Ç–∞ –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω.")) {
            showUploadScreen();
          }
        });

      document
        .getElementById("copyLocalLinkBtn")
        .addEventListener("click", function () {
          const linkInput = document.getElementById("localLink");
          if (linkInput && linkInput.value) {
            copyToClipboard(linkInput.value, this);
          } else {
            alert("–ù–µ—Ç —Å—Å—ã–ª–∫–∏ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è");
          }
        });

      document
        .getElementById("generateManualLinkBtn")
        .addEventListener("click", function () {
          const ipInput = document.getElementById("manualIP");
          const linkContainer = document.getElementById("manualLinkContainer");
          const linkInput = document.getElementById("manualLink");

          if (!ipInput || !ipInput.value) {
            alert("–í–≤–µ–¥–∏—Ç–µ IP-–∞–¥—Ä–µ—Å");
            return;
          }

          const ip = ipInput.value.trim();
          if (!/^\d{1,3}(\.\d{1,3}){3}$/.test(ip)) {
            alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π IP-–∞–¥—Ä–µ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.100)");
            return;
          }

          if (window.currentTestId) {
            const link = `http://${ip}:5000/test/${window.currentTestId}`;
            linkInput.value = link;
            linkContainer.style.display = "block";
            console.log("–°–æ–∑–¥–∞–Ω–∞ —Ä—É—á–Ω–∞—è —Å—Å—ã–ª–∫–∞:", link);
          } else {
            alert("–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–µ—Å—Ç");
          }
        });

      document
        .getElementById("copyManualLinkBtn")
        .addEventListener("click", function () {
          const linkInput = document.getElementById("manualLink");
          if (linkInput && linkInput.value) {
            copyToClipboard(linkInput.value, this);
          } else {
            alert("–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Å—Å—ã–ª–∫—É");
          }
        });

      document.addEventListener("click", function (e) {
        if (
          e.target &&
          e.target.classList &&
          e.target.classList.contains("copyNetworkLinkBtn")
        ) {
          const link = e.target.getAttribute("data-link");
          if (link) {
            console.log("–ö–æ–ø–∏—Ä—É–µ–º —Å–µ—Ç–µ–≤—É—é —Å—Å—ã–ª–∫—É:", link);
            copyToClipboard(link, e.target);
          }
        }
      });

      // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
      window.onload = function () {
        console.log("=== –ü–ê–†–ê–ú–ï–¢–†–´ –°–¢–†–ê–ù–ò–¶–´ ===");
        console.log("–ü–æ–ª–Ω—ã–π URL:", window.location.href);
        console.log("–ü—É—Ç—å (pathname):", window.location.pathname);

        const path = window.location.pathname;

        if (path.startsWith("/test/")) {
          const testId = path.split("/test/")[1];
          console.log("‚úÖ –ù–∞–π–¥–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ç–µ—Å—Ç!");
          console.log("ID —Ç–µ—Å—Ç–∞:", testId);

          if (testId && testId.length > 5) {
            console.log("–ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç –ø–æ —Å—Å—ã–ª–∫–µ...");
            loadTestByLink(testId);
            return;
          } else {
            console.log("‚ùå ID —Ç–µ—Å—Ç–∞ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω");
          }
        } else {
          console.log("‚ÑπÔ∏è –≠—Ç–æ –æ–±—ã—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏");
        }

        console.log("–ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞");
        showUploadScreen();
      };
    </script>
  </body>
</html>
